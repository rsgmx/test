# Git and ssh

## Concepts

 ` git ` uses different transport protocols one of which is ssh.

 Handling of the private keys and entering passphrases can be simplified by using `ssh-agent`. [[ssh](ssh.md)]

 There is also support for entering the passphrase with GUI/X-programm. See ssh-gui--askpass executable.

Q: What happens if you dont use ssh-agent / ssh-add?

## Usage with GITHUB

``>git clone ssh://git@github.com/[user]/[repo].git``

For github worth noting:
1. After setting up your public/private keypair you have to upload your public key to GITHUB throught their web GUI.
2. GITHUB deletes unused public keys (after one year)
3. Always use ``git@github``. Not relevant to use your username. Github can identify you by the publickey setup in your git/ssh environment.
4. Check git ./. GITHUB setup by a trying to connect via SSH:
    > ``> ssh git@github.com``<br>

    Expected response: Hi [user]! You've successfully authenticated... You won't get a terminal session though.



## Setup



## Components

Relevant parts of the ssh-ecoysstem include:
* ``ssh-agent``. Background daemon process used by ssh / git. 
* ``ssh-add``. Adds a specified *identity* to the agent store. Requires to enter the passphrase.

### ssh-agent

``ssh-agent`` runs in the background and provides services to ssh or git for that matter. Whenever ssh/git needs to provide a public key it will turn to ssh-agent and request the information from there.
ssh-agent provides the unlocked (!) key, because the user has provided the required passphrase when ssh-add was run (either from the command prompt or through a login script ~/.profile).

Interprocess communication are organized via a unix-pipe which is provided through a environment variable.
> ``SSH_AUTH_SOCK="/tmp/ssh-xxxx/agent.yyy"``


You can start the ssh-agent process manually from the shell:
> `` $ ssh-agent -s``

and add the required identities:
 > ``ssh-add ~/.ssh/[idenityfile] ``

*Identityfile* is one of the private keys generated by ``key-gen``

Typically your login bash shell is set up so that the setup is provided automatically:

``edit file: ~/.profile:``
 ```
 eval `ssh-agent -s` 
 ssh-add ~/.ssh/[idenityfile] 
```




## How-to and FAQ

1. Setup the ssh relevant environment for use in git.

    (a) Get your keypair OR (b)) generate a keypair


1. Check if ssh-agent is running.

    >``$ ps -al | grep "ssh-agent" ``

2. Check configuration 

3. Add an idenity

4. Create a key-pair

    > ``$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"``
    
    You get prompted for the file location where your private and public key (*.pub) will be stored. Normally defaulting to ``~/.ssh/``

5. Setup configuration of the gitbash

    Make the key available to ssh / ssh-agent:
    * move keyfiles to ~/.ssh/[file]

    make sure ssh-agent gets started for your git-bash
    * edit ~/.profile 



6. Where are key-pairs (*identiy*) stored?
    
   > ``directory: ~/.ssh/ ``

   Check there to see which identities are available.

   You can check wich identities are loaded to the ``ssh-agent``:

   > ``> ssh-add -l ``


## windows specifics

(1) ssh-agent.exe can be seen in the processexplorer. Kill the process if need be.

(2) Git-Bash. In order to use telnet from a gitbash use

>``$ winpty telnet <host> <port>``

(3) Use code from a gitbash to make ssh-agent accessible for the Visual Studio Code git client. 

>``$ code``




## Configuration








Exampletable

| Tables        | Are     f sfsdfsd sdf sdfsdfsadfsdfs      | Cool  |
| :- |-: | -----:|
| col 3 is      | right-aligned | $1600 
| line2         | some more text | $1200
| line3 | ``with some comde text``<br> ``anohter line`` | $1300
| line4 | <code> This is some code <br> with another line </code>| $1400




